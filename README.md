
"version resnet-50"は画像ファイル分類用ディープラーニングモデルをファインチューニングで実装したものです。事前学習済みモデルとしてResnet-50を使用しています。Resnet-50を用いた学習によりミドルクラスのGPUでも動作可能であり、高い判別性能を出しています。ただし製作者が使用するRTX3060 12GBでトレーニングすることを前提に構築されているため、手持ちのGPUのVRAMに合わせて学習率やepo数、バッチサイズを適宜変更することを推奨します。

目的
画像生成が高速化することで短時間で生成できる画像が格段に増え、それらの処理が追い付かないということがよくありました。そこで自分が作りたい画像とそうでない画像、もしくは稀に生成されるクオリティが低い画像をあらかじめ分類するモデルを開発しました。利用者が個人的に欲しい画像とそうでない画像を、ある特徴をもとに分類することができます。さらにファインチューニングの行程を２段階に分けています。CI_model_pre.pyがクオリティがひどく劣るものを間引きします。CI_model_fine.pyは残る画像を特徴付けさらに分類します。これにより多様な分類のレパートリーを学習させることができます。

実行
任意のフォルダで git bushを開き"git clone https://github.com/shogo-code/--version-resnet50" を実行します。CI_model_pre.pyとCI_model_fine.py、もしくはresnet,pyを実行し学習させます。CI_predict.pyで予測を実行します。参考までにpythonは3.10及び3.9.13で正常な動作が確認されています。

学習
判別基準となる”特徴”は学習に使う画像データから決まります。学習に使う画像データの手動選別はLoRAを作成する要領で行います。例えば望ましくない画像にはできるだけ無作為なものを選び、望ましい画像には特徴を絞ることを守っていれば問題なく動作します。

